const questions = [
  {
    letter: 'a',
    status: 0,
    answersAndQuestions: [
      {
        answer: 'abducir',
        question:
          'CON LA A. Dicho de una supuesta criatura extraterrestre: Apoderarse de alguien.',
      },
      {
        answer: 'abrigo',
        question:
          'CON LA A. Prenda de vestir larga, abierta por delante y provista de mangas, que se pone sobre las demás cuando hace frío.',
      },
      {
        answer: 'americano',
        question: 'CON LA A. Natural de América.',
      },
    ],
  },
  {
    letter: 'b',
    status: 0,
    answersAndQuestions: [
      {
        answer: 'bingo',
        question:
          'CON LA B. Juego que ha sacado de quicio a todos los "Skylabers" en las sesiones de precurso.',
      },
      {
        answer: 'botella',
        question:
          'CON LA B. Recipiente de cristal, vidrio, plástico u otro material, con el cuello estrecho, que sirve para contener líquidos.',
      },
      {
        answer: 'bisagra',
        question:
          'CON LA B. Herraje de dos piezas con un eje común que sirve para unir dos superficies permitiendo el giro de ambas o de una sobre la otra.',
      },
    ],
  },
  {
    letter: 'c',
    status: 0,
    answersAndQuestions: [
      {
        answer: 'churumbel',
        question: 'CON LA C. Niño, crío, bebé.',
      },
      {
        answer: 'comunicacion',
        question: 'CON LA C. Acción y efecto de comunicar o comunicarse.',
      },
      {
        answer: 'cometa',
        question:
          'CON LA C. Armazón plana y muy ligera sobre la cual se extiende y pega papel o tela, con una cola de cintas o trozos de papel, que, sujeta con un hilo muy largo, se arroja al aire para que el viento la eleve, como diversión de los muchachos.',
      },
    ],
  },
  {
    letter: 'd',
    status: 0,
    answersAndQuestions: [
      {
        answer: 'diarrea',
        question:
          'CON LA D. Anormalidad en la función del aparato digestivo caracterizada por frecuentes evacuaciones y su consistencia líquida.',
      },
      {
        answer: 'defecto',
        question: 'CON LA D. Imperfección en algo o en alguien.',
      },
      {
        answer: 'disfraz',
        question:
          'CON LA D. Vestido de máscara que sirve para las fiestas y saraos, especialmente en carnaval.',
      },
    ],
  },
  {
    letter: 'e',
    status: 0,
    answersAndQuestions: [
      {
        answer: 'ectoplasma',
        question:
          'CON LA E. Gelatinoso en la función del aparato digestivo caracterizada por frecuentes evacuaciones y su consistencia líquida.',
      },
      {
        answer: 'engreido',
        question:
          'CON LA E. Dicho de una persona: Demasiado convencida de su valer.',
      },
      {
        answer: 'escenario',
        question:
          'CON LA E. En un teatro, lugar donde se representa la obra o el espectáculo.',
      },
    ],
  },
  {
    letter: 'f',
    status: 0,
    answersAndQuestions: [
      {
        answer: 'facil',
        question:
          'CON LA F. Que no requiere gran esfuerzo, capacidad o dificultad.',
      },
      {
        answer: 'feroz',
        question: 'CON LA F. Dicho de un animal: Fiero, agresivo.',
      },
      {
        answer: 'fantasma',
        question:
          'CON LA F. Imagen de una persona muerta que, según algunos, se aparece a los vivos.',
      },
    ],
  },
  {
    letter: 'g',
    status: 0,
    answersAndQuestions: [
      {
        answer: 'galaxia',
        question:
          'CON LA G. Conjunto enorme de estrellas, polvo interestelar, gases y partículas.',
      },
      {
        answer: 'geometrico',
        question: 'CON LA G. Perteneciente o relativo a la geometría.',
      },
      {
        answer: 'gabinete',
        question:
          'CON LA G. Habitación más reducida que la sala, donde se recibe a las personas de confianza.',
      },
    ],
  },
  {
    letter: 'h',
    status: 0,
    answersAndQuestions: [
      {
        answer: 'harakiri',
        question: 'CON LA H. Suicidio ritual japonés por desentrañamiento.',
      },
      {
        answer: 'heroe',
        question:
          'CON LA H. Persona que realiza una acción muy abnegada en beneficio de una causa noble.',
      },
      {
        answer: 'hielo',
        question:
          'CON LA H. Agua convertida en cuerpo sólido y cristalino por un descenso suficiente de temperatura.',
      },
    ],
  },
  {
    letter: 'i',
    status: 0,
    answersAndQuestions: [
      {
        answer: 'iglesia',
        question: 'CON LA I. Templo cristiano.',
      },
      {
        answer: 'inocente',
        question: 'CON LA I. Libre de culpa.',
      },
      {
        answer: 'innato',
        question: 'CON LA I. Connatural y como nacido con la persona misma.',
      },
    ],
  },
  {
    letter: 'j',
    status: 0,
    answersAndQuestions: [
      {
        answer: 'jabali',
        question:
          'CON LA J. Variedad salvaje del cerdo que sale en la película "El Rey León", de nombre Pumba.',
      },
      {
        answer: 'juvenil',
        question: 'CON LA J. Perteneciente o relativo a la juventud.',
      },
      {
        answer: 'jugoso',
        question: 'CON LA J. Que tiene jugo.',
      },
    ],
  },
  {
    letter: 'k',
    status: 0,
    answersAndQuestions: [
      {
        answer: 'kamikaze',
        question:
          'CON LA K. Persona que se juega la vida realizando una acción temeraria.',
      },
      {
        answer: 'karaoke',
        question:
          'CON LA K. Diversión consistente en interpretar una canción sobre un fondo musical grabado, mientras se sigue la letra que aparece en una pantalla.',
      },
      {
        answer: 'karma',
        question: 'CON LA K. En algunas creencias, fuerza espiritual.',
      },
    ],
  },
  {
    letter: 'l',
    status: 0,
    answersAndQuestions: [
      {
        answer: 'licantropo',
        question: 'CON LA L. Hombre lobo.',
      },
      {
        answer: 'laberinto',
        question:
          'CON LA L. Lugar formado artificiosamente por calles y encrucijadas, para confundir a quien se adentre en él, de modo que no pueda acertar con la salida.',
      },
      {
        answer: 'lechal',
        question:
          'CON LA L. Dicho de un animal, especialmente de un cordero: Que mama.',
      },
    ],
  },
  {
    letter: 'm',
    status: 0,
    answersAndQuestions: [
      {
        answer: 'misantropo',
        question:
          'CON LA M. Persona que huye del trato con otras personas o siente gran aversión hacia ellas.',
      },
      {
        answer: 'mecanografia',
        question: 'CON LA M. Técnica de escribir a máquina.',
      },
      {
        answer: 'mocasin',
        question:
          'CON LA M. Calzado propio de los indios norteamericanos, hecho de piel sin curtir.',
      },
    ],
  },
  {
    letter: 'n',
    status: 0,
    answersAndQuestions: [
      {
        answer: 'necedad',
        question: 'CON LA N. Demostración de poca inteligencia.',
      },
      {
        answer: 'nube',
        question:
          'CON LA N. Agregado visible de minúsculas gotitas de agua, de cristales de hielo o de ambos, suspendido en la atmósfera y producido por la condensación de vapor de agua.',
      },
      {
        answer: 'nacer',
        question:
          'CON LA N. Dicho de un ser vivo: Salir del vientre materno, del huevo o de la semilla.',
      },
    ],
  },
  {
    letter: 'ñ',
    status: 0,
    answersAndQuestions: [
      {
        answer: 'señal',
        question:
          'CONTIENE LA Ñ. Indicio que permite deducir algo de lo que no se tiene un conocimiento directo.',
      },
      {
        answer: 'acompañar',
        question:
          'CONTIENE LA Ñ. Estar o ir en compañía de otra u otras personas.',
      },
      {
        answer: 'ñu',
        question:
          'CON LA Ñ. Mamífero rumiante africano de la familia de los antílopes, de color pardo grisáceo, cuya cabeza recuerda la de un toro.',
      },
    ],
  },
  {
    letter: 'o',
    status: 0,
    answersAndQuestions: [
      {
        answer: 'orco',
        question:
          'CON LA O. Humanoide fantástico de apariencia terrible y bestial, piel de color verde creada por el escritor Tolkien.',
      },
      {
        answer: 'obelisco',
        question:
          'CON LA O. Pilar muy alto, de cuatro caras iguales un poco convergentes y terminado por una punta piramidal muy achatada, que sirve de adorno en lugares públicos.',
      },
      {
        answer: 'ocaso',
        question:
          'CON LA O. Puesta del sol, o de otro astro, al trasponer el horizonte.',
      },
    ],
  },
  {
    letter: 'p',
    status: 0,
    answersAndQuestions: [
      {
        answer: 'protoss',
        question:
          'CON LA P. Raza ancestral tecnológicamente avanzada que se caracteriza por sus grandes poderes psíonicos del videojuego StarCraft.',
      },
      {
        answer: 'pachanga',
        question: 'CON LA P. Danza originaria de Cuba.',
      },
      {
        answer: 'piara',
        question: 'CON LA P. Manada de cerdos.',
      },
    ],
  },
  {
    letter: 'q',
    status: 0,
    answersAndQuestions: [
      {
        answer: 'queso',
        question:
          'CON LA Q. Producto obtenido por la maduración de la cuajada de la leche.',
      },
      {
        answer: 'quiebra',
        question:
          'CON LA Q. Rotura de una superficie de cierta dureza o rigidez.',
      },
      {
        answer: 'adoquin',
        question:
          'CONTIENE LA Q. Piedra labrada en forma de prisma rectangular para empedrados y otros usos.',
      },
    ],
  },
  {
    letter: 'r',
    status: 0,
    answersAndQuestions: [
      {
        answer: 'raton',
        question: 'CON LA R. Roedor.',
      },
      {
        answer: 'rabadilla',
        question:
          'CON LA R. En las aves, extremidad movible en donde están las plumas de la cola.',
      },
      {
        answer: 'reaccion',
        question:
          'CON LA R. Efecto secundario inmediato y patente de un medicamento o una terapia.',
      },
    ],
  },
  {
    letter: 's',
    status: 0,
    answersAndQuestions: [
      {
        answer: 'stackoverflow',
        question:
          'CON LA S. Comunidad salvadora de todo desarrollador informático.',
      },
      {
        answer: 'sabado',
        question: 'CON LA S. Sexto día de la semana.',
      },
      {
        answer: 'suave',
        question:
          'CON LA S. Liso y blando al tacto, sin tosquedad ni aspereza.',
      },
    ],
  },
  {
    letter: 't',
    status: 0,
    answersAndQuestions: [
      {
        answer: 'terminator',
        question:
          'CON LA T. Película del director James Cameron que consolidó a Arnold Schwarzenegger como actor en 1984.',
      },
      {
        answer: 'tabarro',
        question:
          'CON LA T. Especie de avispa algo mayor que la corriente, y cuya picadura causa intenso dolor.',
      },
      {
        answer: 'timar',
        question: 'CON LA T. Quitar o hurtar con engaño.',
      },
    ],
  },
  {
    letter: 'u',
    status: 0,
    answersAndQuestions: [
      {
        answer: 'unamuno',
        question:
          'CON LA U. Escritor y filósofo español de la generación del 98 autor del libro "Niebla" en 1914.',
      },
      {
        answer: 'ubicacion',
        question: 'CON LA U. Lugar en que está ubicado algo.',
      },
      {
        answer: 'usual',
        question: 'CON LA U. Común o habitual.',
      },
    ],
  },
  {
    letter: 'v',
    status: 0,
    answersAndQuestions: [
      {
        answer: 'vikingos',
        question:
          'CON LA V. Nombre dado a los miembros de los pueblos nórdicos originarios de Escandinavia, famosos por sus incursiones y pillajes en Europa.',
      },
      {
        answer: 'vaca',
        question: 'CON LA V. Hembra de toro.',
      },
      {
        answer: 'veganismo',
        question:
          'CON LA V. Actitud consistente en rechazar alimentos o artículos de consumo de origen animal.',
      },
    ],
  },
  {
    letter: 'w',
    status: 0,
    answersAndQuestions: [
      {
        answer: 'sandwich',
        question:
          'CONTIENE LA W. Emparedado hecho con dos rebanadas de pan entre las cuales se coloca jamón y queso.',
      },
      {
        answer: 'wok',
        question:
          'CON LA W. Sartén ancha y profunda, generalmente con una o dos asas, originaria de la cocina oriental y que se usa para saltear.',
      },
      {
        answer: 'kiwi',
        question:
          'CONTIENE LA W. Ave apterigiforme, del tamaño de una gallina, que habita en Nueva Zelanda.',
      },
    ],
  },
  {
    letter: 'x',
    status: 0,
    answersAndQuestions: [
      {
        answer: 'botox',
        question:
          'CONTIENE LA X. Toxina bacteriana utilizada en cirujía estética.',
      },
      {
        answer: 'examen',
        question:
          'CONTIENE LA X. Prueba que se hace de la idoneidad de una persona para el ejercicio y profesión de una facultad, oficio o ministerio, o para comprobar o demostrar el aprovechamiento en los estudios.',
      },
      {
        answer: 'saxofonista',
        question: 'CONTIENE LA X. Persona que toca el saxofón.',
      },
    ],
  },
  {
    letter: 'y',
    status: 0,
    answersAndQuestions: [
      {
        answer: 'peyote',
        question:
          'CONTIENE LA Y. Pequeño cáctus conocido por sus alcaloides psicoactivos utilizado de forma ritual y medicinal por indígenas americanos.',
      },
      {
        answer: 'yegua',
        question: 'CON LA Y. Hembra del caballo.',
      },
      {
        answer: 'yema',
        question:
          'CON LA Y. Porción central del huevo en los vertebrados ovíparos.',
      },
    ],
  },
  {
    letter: 'z',
    status: 0,
    answersAndQuestions: [
      {
        answer: 'zen',
        question:
          'CON LA Z. Escuela de budismo que busca la experiencia de la sabiduría más allá del discurso racional.',
      },
      {
        answer: 'zangano',
        question: 'CON LA Z. Macho de la abeja reina.',
      },
      {
        answer: 'zoologia',
        question: 'CON LA Z. Ciencia que trata los animales.',
      },
    ],
  },
];

let pointsRanking = [
  { name: 'Carolina', points: 27 },
  { name: 'Elena', points: 25 },
  { name: 'David', points: 19 },
  { name: 'Lucía', points: 19 },
  { name: 'Jorge', points: 4 },
  { name: 'Sara', points: 1 },
];

const getUserName = () => {
  userName = prompt(
    '¡Hola! Bienvenido/a al juego Pasapalabra, ¿cuál es tu nombre? 🥰 (No vale Orestes... 😜'
  );

  while (userName.toLowerCase() === 'orestes') {
    alert('¡Ey! ¡Dije que no valía Orestes! 😈');
    getUserName();
  }
  return userName;
};

const getFinalWord = (word, numberOfSet) => {
  let turn;
  let isValid = false;

  do {
    turn = prompt(word.answersAndQuestions[numberOfSet].question);
    turn = turn
      .toLowerCase()
      .normalize('NFD')
      .replace(/\p{Diacritic}/gu, '');

    isValid = null !== turn.match(/^[a-z]+$/);
    if (!isValid) {
      alert('¡Ey! ¡Tienes que introducir una palabra! 🙏');
    }
  } while (!isValid);

  return turn;
};

const askForWords = (numberOfSet) => {
  let isEnd = false;
  let countOfRounds = 1;
  let unansweredQuestions = questions.filter(
    (question) => question.status === 0
  );

  do {
    alert(`¡Vamos con la ${countOfRounds}ª ronda! 😉`);
    for (let i = 0; i < unansweredQuestions.length && !isEnd; i++) {
      let turn = getFinalWord(unansweredQuestions[i], numberOfSet);

      if (
        turn === unansweredQuestions[i].answersAndQuestions[numberOfSet].answer
      ) {
        unansweredQuestions[i].status = 1;
        alert('¡Muy bien! ¡Esa es la palabra correcta! Obtienes 1 punto 😍👌');

        continue;
      }

      if ('end' === turn) {
        isEnd = true;

        continue;
      }

      if ('pasapalabra' === turn) {
        alert('¡No pasa nada! Guardamos esta pregunta para después 😘');

        continue;
      }

      unansweredQuestions[i].status = 2;
      alert(
        `¡Oh! Lo siento, esa no es la palabra correcta 😢\n\n La palabra correcta es: ${unansweredQuestions[i].answersAndQuestions[numberOfSet].answer} 😉`
      );
    }

    unansweredQuestions = unansweredQuestions
      .filter((question) => question.status === 0)
      .sort();
    countOfRounds++;
  } while (unansweredQuestions.length > 0 && !isEnd);
};

const giveResultsToTheUser = () => {
  const rigthQuestions = questions.filter(
    (question) => question.status === 1
  ).length;
  const failedQuestions = questions.filter(
    (question) => question.status === 2
  ).length;

  return [
    rigthQuestions,
    failedQuestions,
    questions.length - rigthQuestions - failedQuestions,
  ];
};

const compareRanking = (a, b) => {
  return b.points - a.points;
};

const createPointsRanking = (rigthQuestions, user) => {
  pointsRanking.push({ name: user, points: rigthQuestions });
  pointsRanking = pointsRanking.sort(compareRanking);

  let rankingInfo = '';
  pointsRanking.forEach((pointRanking) => {
    rankingInfo += `\nName: ${pointRanking.name}     Points: ${pointRanking.points}`;
  });
  return alert(
    `Este es el ranking de puntos (según las palabras acertadas) 🔢🏆:\n${rankingInfo}`
  );
};

const playPasapalabra = () => {
  let userName = getUserName();
  let setOfQuestions = 0;

  alert(
    `Ok, ${userName}, antes de empezar, voy a explicarte las reglas del juego:\n\nMisión: adivinar todas las palabras escondidas detrás de su definición (o, al menos las máximas posibles) 🏆\n\n-En cada turno, se mostrará una definición por cada letra del alfabeto (27 en total). Deberás responder con la palabra que creas que es la correcta ✅\n\n-Si tienes dudas, puedes escribir "pasapalabra". En ese caso, el juego saltará a la siguiente letra, dejando esa pendiente para volver a probar más tarde en la siguiente ronda 😊\n\n-Una vez contestadas todas las definiciones, se te mostrará el resultado final: las palabras acertadas y las falladas. Además, también podrás ver el ranking de resultados 🔢\n\n-En cualquier momento puedes escribir "end" para finalizar el juego. En ese caso, se te mostrarán tus resultados pero no podrás entrar en el ranking 🙏\n\nContinúa para comenzar el juego. ¡Mucha suerte! 🍀`
  );

  do {
    for (let i = 0; i < questions.length; i++) {
      questions[i].status = 0;
    }
    askForWords(setOfQuestions);
    setOfQuestions++;
    setOfQuestions = setOfQuestions % 3;

    let [rigthQuestions, failedQuestions, unansweredQuestions] =
      giveResultsToTheUser();

    if (unansweredQuestions !== 0) {
      alert(
        `¡Oh, qué pena! 😥 Tus resultados son:\n\n -Palabras acertadas: ${rigthQuestions} 🟢\n\n -Palabras falladas: ${failedQuestions} 🔴\n\n-Palabras sin responder: ${unansweredQuestions} ❓`
      );
      continue;
    }

    alert(
      `¡Fin de la partida, has contestado a todas las preguntas! 🥰 Tus resultados son:\n\n -Palabras acertadas: ${rigthQuestions} 🟢\n\n -Palabras falladas: ${failedQuestions} 🔴`
    );

    createPointsRanking(rigthQuestions, userName);
  } while (confirm('¿Quieres jugar otra vez? 🧡'));

  alert('¡Gracias por jugar! ¡Adiós! 👋');
};

playPasapalabra();
